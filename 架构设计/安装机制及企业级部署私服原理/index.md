#### 安装机制及企业级部署私服原理

前端工程化离不开 npm(node package manager)或 yarn 这些管理工具。npm 或 yarn 在工程项目中除了负责依赖的安装和维护，还能通过 npm scripts 串联起各个职能部分，让独立的环节自动运转起来。

无论是 npm 还是 yarn，它们的体系都非常庞大，在使用过程中你很可能产生如下疑问。

- 项目依赖出现问题时，使用”删除大法“，即删除 node_modules 和 lockfiles，再重新安装，这样操作是否存在风险？
- 将所有依赖安装到 dependencies 中，不区分 devDependencies 会有问题吗？
- 应用依赖公共库 A 和公共库 B，同时公共库 A 也依赖公共库 B，那么公共库 B 会被多次安装或重复打包吗？
- 在一个项目中，既有人用 npm，也有人用 yarn，这会引发什么问题？

#### npm 内部机制与核心原理

**它会优先安装依赖包到当前项目目录，使得不同应用项目的依赖各成体系，同时还能减轻包作者的 API 兼容性压力，但这样做的缺陷也很明显：如果项目 A 和项目 B 都依赖相同的公共库 C，那么公共库 C 一般会在项目 A 和项目 B 中各被安装一次。这说明，同一个依赖包可能在电脑上被多次安装。**

当然，对于一些工具模板，比如 supervisor 和 gulp，仍然可以使用全局安装模式进行安装，这样方便注册 path 环境变量，利于我们在任何地方直接使用 supervisor、gulp 命令。不过，一般建议不同项目维护自己局部的 gulp 开发工具以适配不同的项目需求。

npm 安装机制如图：
