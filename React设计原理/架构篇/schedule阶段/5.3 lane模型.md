#### lane 模型

从”产生交互“到 render 阶段流程概览如下图，其中小循环、大循环的概念。

5.1 实现了该流程的简易版本，与 React 实际情况对比，其中：

- “不同按钮对应不同优先级”对应“不同交互产生不同优先级”。
- “schedule 方法选出优先级”对应 schedule 阶段；
- “perform 方法执行 work”对应 render 阶段。

简易版本中，schedule 方法会选择一个优先级(最高优先级)。实际情况会更复杂，React 在选出一个优先级的同时，会再选择一批优先级。选出的这个优先级会作为“Schedule 调度的优先级”，选出的一批优先级则会参与 render 阶段。

React 会再“选出一批优先级”的原因与“状态的计算”有关。在 FC 中，状态的定义与修改方式如下：

```js
// 定义状态num
const [num, updateNum] = useState(0);

// 修改状态的方式1
updateNum(2);
// 修改状态的方式2
updateNum((num) => num + 1);
```

执行“修改状态的方式”后，会生成 Update 这一数据结构，不同的 update 拥有不同的优先级。所以“状态的当前值”通常是由“一到多个相同或不同优先级的 update”计算得到的。方式 1 生成的 update 在参与状态计算时，与其他 update 没有依赖关系，比如：

- num 为 1，经由“值为 2 的 update”计算后为 2。
- num 为 100，经由“值为 2 的 update”计算后为 2。

方式 2 生成的 update 在参与状态计算时，与之前的 update 有依赖关系，比如：

- num 为 1，经由“值为 num => num + 1 的 update”计算后为 2；
- num 为 100， 经由“num => num + 1 的 update”计算后为 101；

所以，由于 update 之间存在依赖关系，为了保证“状态的计算结果”符合预期，React 会在更新优先级的基础上再选出一批优先级，共同参与状态计算。
